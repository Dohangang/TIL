/*
ë¬¸ì œ ì„¤ëª…:
ì˜¨ë¼ì¸ ì‡¼í•‘ëª°ì˜ ì‚¬ìš©ìž ì •ë³´ì™€ ì£¼ë¬¸ ì •ë³´ë¥¼ ê´€ë¦¬í•˜ëŠ” ë‘ ê°œì˜ í…Œì´ë¸”ì´ ìžˆë‹¤ê³  ê°€ì •í•©ë‹ˆë‹¤.

í…Œì´ë¸” 1: `Users` (ì‚¬ìš©ìž ì •ë³´)
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ user_id â”‚ user_name â”‚ signup_date â”‚ city        â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ 1       â”‚ Alice     â”‚ 2022-11-15  â”‚ New York    â”‚
  â”‚ 2       â”‚ Bob       â”‚ 2023-01-20  â”‚ Los Angeles â”‚
  â”‚ 3       â”‚ Charlie   â”‚ 2023-03-10  â”‚ Chicago     â”‚
  â”‚ 4       â”‚ David     â”‚ 2022-05-01  â”‚ New York    â”‚
  â”‚ 5       â”‚ Eve       â”‚ 2023-06-25  â”‚ Los Angeles â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

í…Œì´ë¸” 2: `Orders` (ì£¼ë¬¸ ì •ë³´)
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ order_id â”‚ user_id â”‚ order_date â”‚ amount â”‚ status    â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ 101      â”‚ 2       â”‚ 2023-02-15 â”‚ 300.50 â”‚ completed â”‚
  â”‚ 102      â”‚ 1       â”‚ 2023-03-01 â”‚ 150.00 â”‚ cancelled â”‚
  â”‚ 103      â”‚ 3       â”‚ 2023-04-05 â”‚ 450.00 â”‚ completed â”‚
  â”‚ 104      â”‚ 5       â”‚ 2023-07-01 â”‚ 200.00 â”‚ completed â”‚
  â”‚ 105      â”‚ 2       â”‚ 2023-07-10 â”‚ 250.00 â”‚ completed â”‚
  â”‚ 106      â”‚ 3       â”‚ 2023-08-12 â”‚ 120.75 â”‚ completed â”‚
  â”‚ 107      â”‚ 5       â”‚ 2023-08-20 â”‚ 100.00 â”‚ shipped   â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ìš”êµ¬ì‚¬í•­:
2023ë…„ ì´í›„ì— ê°€ìž…í•œ ì‚¬ìš©ìž ì¤‘ì—ì„œ, 'completed' ìƒíƒœì¸ ì£¼ë¬¸ì˜ ì´ì•¡ì´ 500ë‹¬ëŸ¬ë¥¼ ì´ˆê³¼í•˜ëŠ” ìš°ìˆ˜ ê³ ê°ì˜ ëª©ë¡ì„ ì¡°íšŒí•˜ëŠ” SQL ì¿¼ë¦¬ë¥¼ ìž‘ì„±í•˜ì„¸ìš”.
* ì¡°íšŒí•  ì»¬ëŸ¼: ì‚¬ìš©ìžì˜ ID (user_id), ì‚¬ìš©ìž ì´ë¦„ (user_name), ê·¸ë¦¬ê³  ì‚¬ìš©ìžì˜ ì´ ì£¼ë¬¸ì•¡ (total_amount).
* ì •ë ¬: ì´ ì£¼ë¬¸ì•¡ì´ ë†’ì€ ìˆœì„œëŒ€ë¡œ ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬í•´ì£¼ì„¸ìš”.
ì œí•œì‚¬í•­:
ðŸ“Œ 
*/

SELECT
   u.user_id,
   u.user_name,
   SUM(o.amount) AS total_amount 
FROM
   Users u
JOIN
   Orders o ON u.user_id = o.user_id 
WHERE
   u.signup_date >= '2023-01-01' 
   AND o.status = 'completed'       
GROUP BY
   u.user_id, u.user_name 
HAVING
   total_amount > 500 
ORDER BY
   total_amount DESC; 
      
